{
	"variables": {
		"build_number": "{{timestamp}}",
		"centos_version": "6.6",
		"iso_checksum": "5458f357e8a55e3a866dd856896c7e0ac88e7f9220a3dd74c58a3b0acede8e4d",
		"iso_checksum_type": "sha256",
		"iso_url": "http://centos.mirror.facebook.net/6.6/isos/x86_64/CentOS-6.6-x86_64-minimal.iso",
		"tmpdir": "/tmp",
	},

	"builders": [
		{
			"boot_command": [
				"<esc>",
				"<wait>linux ks=http://{{.HTTPIP}}:{{.HTTPPort}}/ks-updates.cfg<enter>"
			],
			"boot_wait": "5s",
			"disk_size": 10000,
			"guest_additions_mode": "disable",
			"guest_os_type": "RedHat_64",
			"http_directory": "./http",
			"iso_checksum": "{{user `iso_checksum`}}",
			"iso_checksum_type": "{{user `iso_checksum_type`}}",
			"iso_url": "{{user `iso_url`}}",
			"name": "vbox4ami",
			"output_directory": "{{user `tmpdir`}}/packer-centos-{{user `centos_version`}}-x86_64-updates-AMI-{{user `build_number`}}",
			"ssh_password": "root",
			"ssh_username": "root",
			"shutdown_command": "shutdown -h now",
			"type": "virtualbox-iso",
			"vboxmanage": [
				[ "modifyvm", "{{.Name}}", "--memory", "1024" ]
			],
			"vm_name": "packer-centos-{{user `centos_version`}}-x86_64-updates-AMI-{{user `build_number`}}"
		},
		{
			"boot_command": [
				"<esc>",
				"<wait>linux ks=http://{{.HTTPIP}}:{{.HTTPPort}}/ks-updates.cfg<enter>"
			],
			"boot_wait": "5s",
			"disk_size": 10000,
			"guest_os_type": "RedHat_64",
			"http_directory": "./http",
			"iso_checksum": "{{user `iso_checksum`}}",
			"iso_checksum_type": "{{user `iso_checksum_type`}}",
			"iso_url": "{{user `iso_url`}}",
			"name": "vbox4vagrant",
			"output_directory": "{{user `tmpdir`}}/packer-centos-{{user `centos_version`}}-x86_64-updates-vagrant-vbox.build-{{user `build_number`}}",
			"ssh_password": "root",
			"ssh_username": "root",
			"shutdown_command": "shutdown -h now",
			"type": "virtualbox-iso",
			"vboxmanage": [
				[ "modifyvm", "{{.Name}}", "--memory", "1024" ]
			],
			"vm_name": "packer-centos-{{user `centos_version`}}-x86_64-updates-vagrant-vbox-{{user `build_number`}}"
		},
		{
			"boot_command": [
				"<esc>",
				"<wait>linux ks=http://{{.HTTPIP}}:{{.HTTPPort}}/ks-updates.cfg<enter>"
			],
			"boot_wait": "5s",
			"disk_size": 10000,
			"guest_os_type": "RedHat_64",
			"http_directory": "./http",
			"iso_checksum": "{{user `iso_checksum`}}",
			"iso_checksum_type": "{{user `iso_checksum_type`}}",
			"iso_url": "{{user `iso_url`}}",
			"name": "vbox4vbox",
			"output_directory": "{{user `tmpdir`}}/packer-centos-{{user `centos_version`}}-x86_64-updates-vbox.build-{{user `build_number`}}",
			"ssh_password": "root",
			"ssh_username": "root",
			"shutdown_command": "shutdown -h now",
			"type": "virtualbox-iso",
			"vboxmanage": [
				[ "modifyvm", "{{.Name}}", "--memory", "1024" ]
			],
			"vm_name": "packer-centos-{{user `centos_version`}}-x86_64-updates-vbox-{{user `build_number`}}"
		},
		{
			"boot_command": [
				"<esc>",
				"<wait>linux ks=http://{{.HTTPIP}}:{{.HTTPPort}}/ks-updates.cfg<enter>"
			],
			"boot_wait": "5s",
			"disk_size": 10000,
			"guest_os_type": "centos-64",
			"http_directory": "./http",
			"iso_checksum": "{{user `iso_checksum`}}",
			"iso_checksum_type": "{{user `iso_checksum_type`}}",
			"iso_url": "{{user `iso_url`}}",
			"name": "vmware4vagrant",
			"output_directory": "{{user `tmpdir`}}/packer-centos-{{user `centos_version`}}-x86_64-updates-vagrant-vmware.build-{{user `build_number`}}",
			"ssh_password": "root",
			"ssh_username": "root",
			"shutdown_command": "shutdown -h now",
			"tools_upload_flavor": "linux",
			"type": "vmware-iso",
			"vm_name": "packer-centos-{{user `centos_version`}}-x86_64-updates-vagrant-vmware-{{user `build_number`}}",
			"vmx_data": {
				"memsize": "1024"
			}
		},
		{
			"boot_command": [
				"<esc>",
				"<wait>linux ks=http://{{.HTTPIP}}:{{.HTTPPort}}/ks-updates.cfg<enter>"
			],
			"boot_wait": "5s",
			"disk_size": 10000,
			"guest_os_type": "centos-64",
			"http_directory": "./http",
			"iso_checksum": "{{user `iso_checksum`}}",
			"iso_checksum_type": "{{user `iso_checksum_type`}}",
			"iso_url": "{{user `iso_url`}}",
			"name": "vmware4vmware",
			"output_directory": "{{user `tmpdir`}}/packer-centos-{{user `centos_version`}}-x86_64-updates-vmware.build-{{user `build_number`}}",
			"ssh_password": "root",
			"ssh_username": "root",
			"shutdown_command": "shutdown -h now",
			"tools_upload_flavor": "linux",
			"type": "vmware-iso",
			"vm_name": "packer-centos-{{user `centos_version`}}-x86_64-updates-vmware-{{user `build_number`}}",
			"vmx_data": {
				"memsize": "1024"
			}
		}
	],

	"provisioners": [
		{
			"script": "provisioners/kernel",
			"type": "shell"
		},
		{
			"script": "provisioners/ifcfg-eth0",
			"type": "shell"
		},
		{
			"script": "provisioners/ntp",
			"type": "shell"
		},
		{
			"script": "provisioners/man",
			"type": "shell"
		},
		{
			"script": "provisioners/epel",
			"type": "shell"
		},
		{
			"only": [ "vbox4ami" ],
			"script": "provisioners/cloud-init",
			"type": "shell"
		},
		{
			"only": [ "vbox4vagrant", "vmware4vagrant" ],
			"script": "provisioners/vagrant",
			"type": "shell"
		},
		{
			"script": "provisioners/ssh",
			"type": "shell"
		},
		{
			"only": [ "vbox4ami" ],
			"script": "provisioners/grub",
			"type": "shell"
		},
		{
			"only": [ "vbox4ami" ],
			"script": "provisioners/fstab",
			"type": "shell"
		},
		{
			"only": [ "vbox4vagrant", "vbox4vbox" ],
			"script": "provisioners/virtualbox",
			"type": "shell"
		},
		{
			"only": [ "vmware4vagrant", "vmware4vmware" ],
			"script": "provisioners/vmware",
			"type": "shell"
		},
		{
			"except": [
				"vbox4vagrant",
				"vbox4vbox",
				"vmware4vagrant",
				"vmware4vmware"
			],
			"script": "provisioners/lock_root",
			"type": "shell"
		},
		{
			"script": "provisioners/cleanup",
			"type": "shell"
		}
	],

	"post-processors": [
		{
			"only": [ "vbox4vagrant" ],
			"output": "{{user `tmpdir`}}/packer-centos-{{user `centos_version`}}-x86_64-updates-{{user `puppet_server`}}-vagrant-vbox-{{user `build_number`}}.box",
			"type": "vagrant"
		},
		{
			"only": [ "vmware4vagrant" ],
			"output": "{{user `tmpdir`}}/packer-centos-{{user `centos_version`}}-x86_64-updates-{{user `puppet_server`}}-vagrant-vmware-{{user `build_number`}}.box",
			"type": "vagrant"
		}
	]
}
